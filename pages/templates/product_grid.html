{% extends 'base.html' %}
{% load static %}

{% block header %}
{% include 'header.html' %}
{% endblock header %}

{% block content %}

<div id="prod-parent" class="container-fluid mt-5 pt-5 pb-3 d-flex flex-sm-row">
        <div class="row border rounded-3 w-100">
            <nav id="prod-nav" class="navbar navbar-expand-lg navbar-light bg-light shadow-sm navbar-height py-0">
                    <div id="navCategories" class="collapse navbar-collapse">
                        <ul class="navbar-nav">
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="dropdown01" data-bs-toggle="dropdown" aria-expanded="false">
                                Categories
                                </a>
                                <ul class="dropdown-menu bg-light" aria-labelledby="dropdown01">
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category='all' availability=availability order=order pagination=pagination page=products.number %}">All</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category='red' availability=availability order=order pagination=pagination page=products.number %}">Red Wine</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category='white' availability=availability order=order pagination=pagination page=products.number %}">White Wine</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category='rose' availability=availability order=order pagination=pagination page=products.number %}">Ros√© Wine</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div id="navStock" class="collapse navbar-collapse">
                        <ul class="navbar-nav">
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="dropdown02" data-bs-toggle="dropdown" aria-expanded="false">
                                Availability
                                </a>
                                <ul class="dropdown-menu bg-light" aria-labelledby="dropdown02">
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability='all' order=order pagination=pagination page=products.number %}">All</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability='sufficient' order=order pagination=pagination page=products.number %}">In Stock</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability='limited' order=order pagination=pagination page=products.number %}">Limited Stock</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability='lastproducts' order=order pagination=pagination page=products.number %}">Last Items</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability='outofstock' order=order pagination=pagination page=products.number %}">Out Of Stock</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div id="navOrder" class="collapse navbar-collapse">
                        <ul class="navbar-nav">
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="dropdown03" data-bs-toggle="dropdown" aria-expanded="false">
                                Sort By
                                </a>
                                <ul class="dropdown-menu bg-light" aria-labelledby="dropdown03">
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability=availability order='newest' pagination=pagination page=products.number %}">Newest</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability=availability order='price_asc' pagination=pagination page=products.number %}">Price Ascending</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability=availability order='price_desc' pagination=pagination page=products.number %}">Price Descending</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability=availability order='popularity' pagination=pagination page=products.number %}">Popularity</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability=availability order='discount' pagination=pagination page=products.number %}">Discount</a></li>
                                <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability=availability order='reviews' pagination=pagination page=products.number %}">Review score</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div id="navPagination" class="collapse navbar-collapse">
                    <ul class="navbar-nav">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="dropdown04" data-bs-toggle="dropdown" aria-expanded="false">
                            Products on page
                            </a>
                            <ul class="dropdown-menu bg-light" aria-labelledby="dropdown04">
                            <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability=availability order=order pagination=10 page=products.number %}">10 Products</a></li>
                            <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability=availability order=order pagination=25 page=products.number %}">25 Products</a></li>
                            <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability=availability order=order pagination=50 page=products.number %}">50 Products</a></li>
                            <li><a class="dropdown-item text-secondary" href="{% url 'product_grid' category=category availability=availability order=order pagination=100 page=products.number %}">100 products</a></li>
                            </ul>
                        </li>
                    </ul>
                    </div>
                </div>
                </nav>
        </div>
        <div class="row row-cols-4 w-100">
            {% for product in products %}
                <div class="col md-4 mt-2">
                    <div class="card w-100" style="width: 14rem; border: none">
                    <a href="{% url 'product_page' product_slug=product.slug %}" style="text-decoration: none">
                        <div class="position-relative">
                          <img src="{{product.productimage_set.first.image.url}}" class="card-img-top scale-effect" alt="">
                          {% if product.discount > 0 %}
                            <div class="position-absolute text-light bg-danger rounded-pill py-2" style="width: 2.5rem; left: 5rem; bottom: 18rem"> -{{product.discount}}%</div>
                          {% endif%}
                        </div>
                    </a>
                    <form action="{% url 'cart:shopping_cart_add' product.id %}" method="POST">
                        {% csrf_token %}
                        <div class="card-body text-center">
                            <p class="fs-5 fw-bold">{{product.price}} &euro;</p>
                            <p class="card-text">{{product.name}}</p>
                            <button class="btn btn-outline-info"><i class="fa fa-shopping-cart" aria-hidden="true"></i> Purchase</button>
                        </div>
                    </form>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="d-flex w-100">
            <div class="mx-auto">
            <span>
                {% if products.has_previous %}
                    <a href="{% url 'product_grid' category=category availability=availability order=order pagination=pagination page=1 %}">&laquo; first</a>
                    <a href="{% url 'product_grid' category=category availability=availability order=order pagination=pagination page=products.previous_page_number %}">previous</a>
                {% endif %}
        
                <span>
                    Page {{ products.number }} of {{ products.paginator.num_pages }}.
                </span>
        
                {% if products.has_next %}
                    <a href="{% url 'product_grid' category=category availability=availability order=order pagination=pagination page=products.next_page_number %}">next</a>
                    <a href="{% url 'product_grid' category=category availability=availability order=order pagination=pagination page=products.paginator.num_pages %}">last &raquo;</a>
                {% endif %}
            </span>
            </div>
        </div>

</div>
{% endblock content %}

{% block footer %}
{% include 'footer.html' %}
{% endblock footer %}